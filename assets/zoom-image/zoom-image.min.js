!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.zoom=e()}(this,function(){"use strict";function t(){-1===g&&(g=window.pageYOffset),Math.abs(g-window.pageYOffset)>=40&&a()}function e(t){27===t.keyCode&&a()}function i(t){var e=t.touches[0];null!==e&&(y=e.pageY,t.target.addEventListener("touchmove",n))}function n(t){var e=t.touches[0];null!==e&&Math.abs(e.pageY-y)>10&&(a(),t.target.removeEventListener("touchmove",n))}function o(){a()}function s(){document.addEventListener("scroll",t),document.addEventListener("keyup",e),document.addEventListener("touchstart",i),document.addEventListener("click",o,!0)}function r(){document.removeEventListener("scroll",t),document.removeEventListener("keyup",e),document.removeEventListener("touchstart",i),document.removeEventListener("click",o,!0)}function a(t){null!==p&&(t?p.dispose():p.close(),r(),p=null)}function c(t){if(!document.body.classList.contains("zoom-overlay-open"))return t.metaKey||t.ctrlKey?void window.open(t.target.getAttribute("data-original")||t.target.src,"_blank"):void(t.target.width>=d()-v||(a(!0),p=new f(t.target,v),p.zoom(),s()))}var d=function(){return document.documentElement.clientWidth},m=function(){return document.documentElement.clientHeight},u=function(t){var e=t.getBoundingClientRect(),i=document.documentElement,n=window;return{top:e.top+n.pageYOffset-i.clientTop,left:e.left+n.pageXOffset-i.clientLeft}},l=function(t,e,i){var n=function(t){t.target.removeEventListener(e,n),i()};t.addEventListener(e,n)},h=function(t,e){this.w=t,this.h=e},f=function(t,e){this.img=t,this.preservedTransform=t.style.transform,this.wrap=null,this.overlay=null,this.offset=e};f.prototype.forceRepaint=function(){this.img.offsetWidth},f.prototype.zoom=function(){var t=new h(this.img.naturalWidth,this.img.naturalHeight);this.wrap=document.createElement("div"),this.wrap.classList.add("zoom-img-wrap"),this.img.parentNode.insertBefore(this.wrap,this.img),this.wrap.appendChild(this.img),this.img.classList.add("zoom-img"),this.img.setAttribute("data-action","zoom-out"),this.overlay=document.createElement("div"),this.overlay.classList.add("zoom-overlay"),document.body.appendChild(this.overlay),this.forceRepaint();var e=this.calculateScale(t);this.forceRepaint(),this.animate(e),document.body.classList.add("zoom-overlay-open")},f.prototype.calculateScale=function(t){var e=t.w/this.img.width,i=d()-this.offset,n=m()-this.offset,o=t.w/t.h,s=i/n;return t.w<i&&t.h<n?e:o<s?n/t.h*e:i/t.w*e},f.prototype.animate=function(t){var e=u(this.img),i=window.pageYOffset,n=d()/2,o=i+m()/2,s=e.left+this.img.width/2,r=e.top+this.img.height/2,a=n-s,c=o-r,l="scale("+t+")",h="translate3d("+a+"px, "+c+"px, 0px)";this.img.style.transform=l,this.wrap.style.transform=h},f.prototype.dispose=function(){null!==this.wrap&&null!==this.wrap.parentNode&&(this.img.classList.remove("zoom-img"),this.img.setAttribute("data-action","zoom"),this.wrap.parentNode.insertBefore(this.img,this.wrap),this.wrap.parentNode.removeChild(this.wrap),document.body.removeChild(this.overlay),document.body.classList.remove("zoom-overlay-transitioning"))},f.prototype.close=function(){var t=this;document.body.classList.add("zoom-overlay-transitioning"),this.img.style.transform=this.preservedTransform,0===this.img.style.length&&this.img.removeAttribute("style"),this.wrap.style.transform="none",l(this.img,"transitionend",function(){t.dispose(),document.body.classList.remove("zoom-overlay-open")})};var p=null,v=80,g=-1,y=-1;return function(t){return t.setAttribute("data-action","zoom"),t.addEventListener("click",c),function(){return t.removeEventListener("click",c)}}});
//# sourceMappingURL=zoom-image.min.js.map
