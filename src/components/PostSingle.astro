---
import PostMeta from './PostMeta.astro'
import PostNav from './post/PostNav.astro'
import FormNewsletter from './newsletter/Form.astro'

import s from './PostSingle.module.css'

const {
  headers,
  post: { title, isPage },
} = Astro.props
---

<style>
  .newsletter {
    background-color: var(--surface-2);
    padding: var(--size-3);
    border-radius: var(--radius-2);
    margin-inline: calc(-1 * var(--size-3));
  }
</style>

<article id="post" class:list={['flow', s.post]}>
  <h1 class={s.title}>{title}</h1>

  {
    !isPage && (
      <>
        <PostMeta post={Astro.props.post} />
        <PostNav headers={headers} />
      </>
    )
  }

  <div class={s.wrapper}>
    <div class="flow">
      <div class={s.content}>
        <slot />
      </div>

      {
        !isPage && (
          <div class="newsletter mb-4">
            <h3>Bạn thích bài viết này?</h3>

            <p>
              Đăng ký ngay để nhận những tin tức mới nhất về lập trình frontend trong tuần. Bản tin sẽ được gửi vào mỗi
              cuối tuần ✌️
            </p>

            <FormNewsletter>
              <input type="hidden" name="metadata__FormLocation" value="SinglePost" />
            </FormNewsletter>
          </div>
        )
      }

      {
        !isPage && (
          <div id="comments">
            <script
              is:inline
              src="https://utteranc.es/client.js"
              repo="ehkoo/web"
              issue-term="pathname"
              label="web-comments"
              theme="github-light"
              crossorigin="anonymous"
              async
            />
          </div>
        )
      }
    </div>
  </div>
</article>
